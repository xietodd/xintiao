<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è–ªé‡‘çŸ¿å·¥ - å¸¦è–ªæ‘¸é±¼è´¢å¯Œå¯è§†åŒ–</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #fff;
            overflow: hidden;
            height: 100vh;
        }

        /* åˆå§‹åŒ–é¡µé¢æ ·å¼ */
        .setup-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: radial-gradient(circle, #667eea 0%, #764ba2 100%);
        }

        .setup-title {
            font-size: 3rem;
            margin-bottom: 2rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .salary-input {
            padding: 1rem 2rem;
            font-size: 1.5rem;
            border: none;
            border-radius: 50px;
            text-align: center;
            margin-bottom: 1rem;
            width: 300px;
            background: rgba(255,255,255,0.9);
            color: #333;
        }

        .salary-input:focus {
            outline: none;
            box-shadow: 0 0 20px rgba(255,255,255,0.5);
        }

        .start-btn {
            padding: 1rem 3rem;
            font-size: 1.5rem;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            border: none;
            border-radius: 50px;
            color: #333;
            cursor: pointer;
            transition: transform 0.3s;
            font-weight: bold;
        }

        .start-btn:hover {
            transform: scale(1.1);
        }

        .switch-mode {
            margin-top: 1rem;
            color: #ccc;
            cursor: pointer;
            text-decoration: underline;
        }

        /* ä¸»ç•Œé¢æ ·å¼ */
        .main-container {
            display: none;
            height: 100vh;
            position: relative;
            background: linear-gradient(135deg, #0f0c29 0%, #302b63 50%, #24243e 100%);
        }

        .money-display {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 10;
        }

        .money-amount {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255,215,0,0.5);
            margin-bottom: 0.5rem;
        }

        .money-info {
            font-size: 1.2rem;
            color: #ccc;
            margin-bottom: 0.5rem;
        }

        .time-info {
            font-size: 1rem;
            color: #888;
        }

        /* æ§åˆ¶é¢æ¿ */
        .control-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.5);
            padding: 1rem;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            z-index: 100;
        }

        .control-btn {
            margin: 0.25rem;
            padding: 0.5rem 1rem;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 5px;
            color: #fff;
            cursor: pointer;
            transition: background 0.3s;
        }

        .control-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        /* é‡‘é’±åŠ¨ç”» */
        .coin {
            position: absolute;
            width: 40px;
            height: 40px;
            background: radial-gradient(circle, #FFD700 0%, #FFA500 100%);
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(255,215,0,0.5);
            animation: fall linear;
            cursor: pointer;
            z-index: 5;
        }

        .coin::before {
            content: 'Â¥';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
            }
        }

        .cash {
            position: absolute;
            width: 60px;
            height: 30px;
            background: linear-gradient(90deg, #85bb65 0%, #5a8f41 100%);
            border-radius: 3px;
            animation: float linear;
            z-index: 5;
        }

        .cash::before {
            content: 'Â¥100';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 12px;
            color: #fff;
            font-weight: bold;
        }

        @keyframes float {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* è€æ¿é”®ä¼ªè£…ç•Œé¢ */
        .boss-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #1e1e1e;
            z-index: 1000;
            padding: 20px;
            font-family: 'Consolas', 'Monaco', monospace;
            color: #d4d4d4;
            overflow-y: auto;
        }

        .code-editor {
            background: #1e1e1e;
            border-radius: 5px;
            padding: 20px;
            height: calc(100vh - 40px);
            overflow-y: auto;
        }

        .line-numbers {
            color: #858585;
            margin-right: 20px;
            user-select: none;
        }

        .code-line {
            margin: 2px 0;
            font-size: 14px;
            line-height: 1.5;
        }

        .keyword { color: #569cd6; }
        .string { color: #ce9178; }
        .comment { color: #6a9955; }
        .function { color: #dcdcaa; }

        /* è®¾ç½®é¢æ¿æ ·å¼ */
        .settings-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .settings-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1e1e2e 0%, #2d2d44 100%);
            border-radius: 20px;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
        }

        .settings-content h3 {
            text-align: center;
            margin-bottom: 1.5rem;
            color: #FFD700;
            font-size: 1.5rem;
        }

        .setting-group {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .setting-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #FFD700;
            font-size: 1.1rem;
        }

        .setting-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 0.5rem 0;
            color: #ccc;
            font-size: 0.9rem;
        }

        .setting-row input[type="number"],
        .setting-row input[type="time"],
        .setting-row select {
            padding: 0.3rem;
            border-radius: 5px;
            border: 1px solid #444;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            text-align: center;
            min-width: 100px;
        }

        .setting-row input[type="range"] {
            flex: 1;
            margin: 0 0.5rem;
            accent-color: #FFD700;
        }

        .settings-buttons {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
            margin-top: 1rem;
        }

        .settings-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .settings-btn:nth-child(1) {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }

        .settings-btn:nth-child(2) {
            background: linear-gradient(45deg, #ff9800, #e68900);
            color: white;
        }

        .settings-btn:nth-child(3) {
            background: linear-gradient(45deg, #f44336, #da190b);
            color: white;
        }

        .settings-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .money-amount {
                font-size: 2.5rem;
            }
            
            .setup-title {
                font-size: 2rem;
            }
            
            .salary-input {
                width: 250px;
                font-size: 1.2rem;
            }

            .settings-content {
                width: 95%;
                padding: 1rem;
            }
            
            .setting-row {
                flex-direction: column;
                align-items: stretch;
                text-align: center;
            }
            
            .setting-row span {
                margin-bottom: 0.3rem;
            }
        }
    </style>
</head>
<body>
    <!-- åˆå§‹åŒ–é¡µé¢ -->
        <div class="setup-container" id="setupContainer">
            <h1 class="setup-title">ğŸ’° è–ªé‡‘çŸ¿å·¥ ğŸ’°</h1>
            <div style="background: rgba(255,255,255,0.1); padding: 2rem; border-radius: 20px; margin-bottom: 2rem;">
                <input type="number" 
                       class="salary-input" 
                       id="salaryInput" 
                       placeholder="è¯·è¾“å…¥æ‚¨çš„æ—¥è–ªï¼ˆå…ƒï¼‰" 
                       min="1"
                       step="0.01">
                <div style="margin: 1rem 0; color: #ccc;">æˆ–</div>
                <input type="number" 
                       class="salary-input" 
                       id="hourlyInput" 
                       placeholder="è¯·è¾“å…¥æ‚¨çš„æ—¶è–ªï¼ˆå…ƒï¼‰" 
                       min="1"
                       step="0.01"
                       style="display: none;">
                <div style="margin: 1rem 0; color: #ccc;">å·¥ä½œæ—¶é—´è®¾ç½®</div>
                <div style="display: flex; gap: 1rem; justify-content: center; align-items: center; margin-bottom: 1rem;">
                    <input type="time" 
                           id="workStartTime" 
                           value="09:00"
                           style="padding: 0.5rem; border-radius: 10px; border: none; text-align: center;">
                    <span style="color: #ccc;">è‡³</span>
                    <input type="time" 
                           id="workEndTime" 
                           value="18:00"
                           style="padding: 0.5rem; border-radius: 10px; border: none; text-align: center;">
                </div>
                <div style="color: #aaa; font-size: 0.9rem;">
                    å·¥ä½œæ—¶é•¿ï¼š<span id="workHoursDisplay">9</span>å°æ—¶
                </div>
            </div>
            <button class="start-btn" onclick="startMining()">å¼€å§‹èµšé’±ï¼</button>
            <div class="switch-mode" onclick="toggleSalaryMode()" id="modeToggle">åˆ‡æ¢ä¸ºæ—¶è–ªè¾“å…¥</div>
        </div>

    <!-- ä¸»ç•Œé¢ -->
        <div class="main-container" id="mainContainer">
            <div class="money-display">
                <div class="money-amount" id="moneyAmount">Â¥ 0.00</div>
                <div class="money-info" id="moneyInfo">ä»Šæ—¥å·²èµšå–</div>
                <div class="time-info" id="timeInfo">æœ¬æ¬¡æ‘¸é±¼æ—¶é•¿ï¼š0å°æ—¶0åˆ†é’Ÿ</div>
            </div>

            <div class="control-panel">
                <button class="control-btn" onclick="togglePause()" id="pauseBtn">æš‚åœ</button>
                <button class="control-btn" onclick="toggleMute()" id="muteBtn">é™éŸ³</button>
                <button class="control-btn" onclick="toggleSettings()">âš™ï¸è®¾ç½®</button>
                <button class="control-btn" onclick="resetSettings()">é‡ç½®</button>
                <button class="control-btn" onclick="showHelp()">å¸®åŠ©</button>
            </div>

            <!-- è®¾ç½®é¢æ¿ -->
            <div class="settings-panel" id="settingsPanel">
                <div class="settings-content">
                    <h3>âš™ï¸ è®¾ç½®é¢æ¿</h3>
                    
                    <div class="setting-group">
                        <label>è–ªèµ„è®¾ç½®</label>
                        <div class="setting-row">
                            <span>å½“å‰æ¨¡å¼ï¼š</span>
                            <select id="settingsSalaryMode" onchange="updateSalaryMode()">
                                <option value="daily">æ—¥è–ªæ¨¡å¼</option>
                                <option value="hourly">æ—¶è–ªæ¨¡å¼</option>
                            </select>
                        </div>
                        <div class="setting-row">
                            <span>è–ªèµ„é‡‘é¢ï¼š</span>
                            <input type="number" id="settingsSalaryAmount" step="0.01" min="0" placeholder="è¾“å…¥é‡‘é¢">
                        </div>
                    </div>

                    <div class="setting-group">
                        <label>å·¥ä½œæ—¶é—´</label>
                        <div class="setting-row">
                            <span>ä¸Šç­æ—¶é—´ï¼š</span>
                            <input type="time" id="settingsStartTime" onchange="updateWorkSettings()">
                        </div>
                        <div class="setting-row">
                            <span>ä¸‹ç­æ—¶é—´ï¼š</span>
                            <input type="time" id="settingsEndTime" onchange="updateWorkSettings()">
                        </div>
                        <div class="setting-row">
                            <span>å·¥ä½œæ—¶é•¿ï¼š</span>
                            <span id="settingsWorkHours">9.0å°æ—¶</span>
                        </div>
                    </div>

                    <div class="setting-group">
                        <label>åŠ¨ç”»è®¾ç½®</label>
                        <div class="setting-row">
                            <span>é‡‘å¸æ‰è½é¢‘ç‡ï¼š</span>
                            <input type="range" id="settingsCoinRate" min="1" max="10" value="3" onchange="updateAnimationSettings()">
                            <span id="coinRateValue">3</span>
                        </div>
                        <div class="setting-row">
                            <span>é’ç¥¨å‡ºç°é¢‘ç‡ï¼š</span>
                            <input type="range" id="settingsCashRate" min="1" max="10" value="1" onchange="updateAnimationSettings()">
                            <span id="cashRateValue">1</span>
                        </div>
                        <div class="setting-row">
                            <span>åŠ¨ç”»é€Ÿåº¦ï¼š</span>
                            <input type="range" id="settingsAnimSpeed" min="0.5" max="3" step="0.1" value="1" onchange="updateAnimationSettings()">
                            <span id="animSpeedValue">1.0x</span>
                        </div>
                    </div>

                    <div class="setting-group">
                        <label>æ˜¾ç¤ºè®¾ç½®</label>
                        <div class="setting-row">
                            <span>æ•°å­—æ›´æ–°é¢‘ç‡ï¼š</span>
                            <select id="settingsUpdateFreq" onchange="updateDisplaySettings()">
                                <option value="100">0.1ç§’</option>
                                <option value="500">0.5ç§’</option>
                                <option value="1000" selected>1ç§’</option>
                            </select>
                        </div>
                        <div class="setting-row">
                            <span>æ˜¾ç¤ºå°æ•°ä½æ•°ï¼š</span>
                            <input type="range" id="settingsDecimals" min="0" max="4" value="2" onchange="updateDisplaySettings()">
                            <span id="decimalsValue">2</span>
                        </div>
                    </div>

                    <div class="setting-group">
                        <label>éŸ³æ•ˆè®¾ç½®</label>
                        <div class="setting-row">
                            <span>éŸ³æ•ˆéŸ³é‡ï¼š</span>
                            <input type="range" id="settingsVolume" min="0" max="1" step="0.1" value="0.3" onchange="updateAudioSettings()">
                            <span id="volumeValue">30%</span>
                        </div>
                        <div class="setting-row">
                            <span>éŸ³è°ƒé«˜ä½ï¼š</span>
                            <input type="range" id="settingsPitch" min="0.5" max="2" step="0.1" value="1" onchange="updateAudioSettings()">
                            <span id="pitchValue">1.0x</span>
                        </div>
                    </div>

                    <div class="setting-buttons">
                        <button class="settings-btn" onclick="applySettings()">åº”ç”¨è®¾ç½®</button>
                        <button class="settings-btn" onclick="resetToDefaults()">æ¢å¤é»˜è®¤</button>
                        <button class="settings-btn" onclick="toggleSettings()">å…³é—­</button>
                    </div>
                </div>
            </div>

    <!-- è€æ¿é”®ä¼ªè£…ç•Œé¢ -->
    <div class="boss-screen" id="bossScreen">
        <div class="code-editor">
            <div class="code-line"><span class="line-numbers">1</span><span class="comment">// ç³»ç»Ÿç›‘æ§è„šæœ¬ - å®æ—¶æ€§èƒ½åˆ†æ</span></div>
            <div class="code-line"><span class="line-numbers">2</span><span class="keyword">import</span> <span class="string">"system/monitor"</span></div>
            <div class="code-line"><span class="line-numbers">3</span><span class="keyword">import</span> <span class="string">"analytics/logger"</span></div>
            <div class="code-line"><span class="line-numbers">4</span></div>
            <div class="code-line"><span class="line-numbers">5</span><span class="keyword">func</span> <span class="function">main</span>() {</div>
            <div class="code-line"><span class="line-numbers">6</span>    <span class="comment">// åˆå§‹åŒ–ç›‘æ§å™¨</span></div>
            <div class="code-line"><span class="line-numbers">7</span>    monitor := <span class="function">NewSystemMonitor</span>()</div>
            <div class="code-line"><span class="line-numbers">8</span>    </div>
            <div class="code-line"><span class="line-numbers">9</span>    <span class="comment">// æ”¶é›†CPUä½¿ç”¨ç‡</span></div>
            <div class="code-line"><span class="line-numbers">10</span>    cpuUsage := monitor.<span class="function">GetCPUUsage</span>()</div>
            <div class="code-line"><span class="line-numbers">11</span>    <span class="keyword">if</span> cpuUsage > <span class="string">80</span> {</div>
            <div class="code-line"><span class="line-numbers">12</span>        logger.<span class="function">Warn</span>(<span class="string">"CPUä½¿ç”¨ç‡è¿‡é«˜: %v%%"</span>, cpuUsage)</div>
            <div class="code-line"><span class="line-numbers">13</span>    }</div>
            <div class="code-line"><span class="line-numbers">14</span></div>
            <div class="code-line"><span class="line-numbers">15</span>    <span class="comment">// ç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µ</span></div>
            <div class="code-line"><span class="line-numbers">16</span>    memory := monitor.<span class="function">GetMemoryUsage</span>()</div>
            <div class="code-line"><span class="line-numbers">17</span>    <span class="keyword">for</span> _, proc := <span class="keyword">range</span> memory.<span class="function">Processes</span> {</div>
            <div class="code-line"><span class="line-numbers">18</span>        <span class="keyword">if</span> proc.<span class="function">Usage</span>() > <span class="string">1GB</span> {</div>
            <div class="code-line"><span class="line-numbers">19</span>            logger.<span class="function">Info</span>(<span class="string">"è¿›ç¨‹ %s å†…å­˜ä½¿ç”¨: %v"</span>, proc.<span class="function">Name</span>(), proc.<span class="function">Usage</span>())</div>
            <div class="code-line"><span class="line-numbers">20</span>        }</div>
            <div class="code-line"><span class="line-numbers">21</span>    }</div>
            <div class="code-line"><span class="line-numbers">22</span>}</div>
            <div class="code-line"><span class="line-numbers">23</span></div>
            <div class="code-line"><span class="line-numbers">24</span><span class="comment">// å®æ—¶æ›´æ–°: 2024-10-27 15:30:45</span></div>
            <div class="code-line"><span class="line-numbers">25</span><span class="comment">// CPU: 23% | å†…å­˜: 4.2GB/16GB | ç½‘ç»œ: 1.2MB/s</span></div>
        </div>
    </div>

    <script>
        let salary = 0;
        let salary = 0;
        let startTime = null;
        let isPaused = false;
        let isMuted = false;
        let useHourlyInput = false;
        let workStartHour = 9;
        let workEndHour = 18;
        let workMinutes = 60;
        let animationInterval;
        let moneyInterval;
        let updateFrequency = 100;
        let decimalPlaces = 2;
        let coinDropRate = 3;
        let cashDropRate = 1;
        let animationSpeed = 1;
        let audioVolume = 0.3;
        let audioPitch = 1;

        // åˆå§‹åŒ–æ£€æŸ¥
        window.onload = function() {
            // åŠ è½½åŸºç¡€è®¾ç½®
            const savedSalary = localStorage.getItem('salary');
            const savedUseHourly = localStorage.getItem('useHourlyInput');
            const savedStart = localStorage.getItem('workStartTime');
            const savedEnd = localStorage.getItem('workEndTime');
            
            // åŠ è½½é«˜çº§è®¾ç½®
            coinDropRate = parseInt(localStorage.getItem('coinDropRate')) || 3;
            cashDropRate = parseInt(localStorage.getItem('cashDropRate')) || 1;
            animationSpeed = parseFloat(localStorage.getItem('animationSpeed')) || 1;
            updateFrequency = parseInt(localStorage.getItem('updateFrequency')) || 100;
            decimalPlaces = parseInt(localStorage.getItem('decimalPlaces')) || 2;
            audioVolume = parseFloat(localStorage.getItem('audioVolume')) || 0.3;
            audioPitch = parseFloat(localStorage.getItem('audioPitch')) || 1;
            
            if (savedSalary) {
                const salaryValue = parseFloat(savedSalary);
                useHourlyInput = savedUseHourly === 'true';
                salary = useHourlyInput ? salaryValue : salaryValue / (workMinutes / 60);
                
                if (savedStart) document.getElementById('workStartTime').value = savedStart;
                if (savedEnd) document.getElementById('workEndTime').value = savedEnd;
                
                updateWorkHours();
                showMainInterface();
            }
            
            // ç›‘å¬æ—¶é—´å˜åŒ–
            document.getElementById('workStartTime').addEventListener('change', updateWorkHours);
            document.getElementById('workEndTime').addEventListener('change', updateWorkHours);
        };

        function updateWorkHours() {
            const startTime = document.getElementById('workStartTime').value;
            const endTime = document.getElementById('workEndTime').value;
            
            const [startH, startM] = startTime.split(':').map(Number);
            const [endH, endM] = endTime.split(':').map(Number);
            
            let totalMinutes = (endH * 60 + endM) - (startH * 60 + startM);
            if (totalMinutes < 0) totalMinutes += 24 * 60; // å¤„ç†è·¨å¤©æƒ…å†µ
            
            workMinutes = totalMinutes;
            workStartHour = startH + startM / 60;
            workEndHour = endH + endM / 60;
            
            document.getElementById('workHoursDisplay').textContent = (workMinutes / 60).toFixed(1);
        }

        function toggleSalaryMode() {
            useHourlyInput = !useHourlyInput;
            const dailyInput = document.getElementById('salaryInput');
            const hourlyInput = document.getElementById('hourlyInput');
            const modeText = document.getElementById('modeToggle');
            
            if (useHourlyInput) {
                dailyInput.style.display = 'none';
                hourlyInput.style.display = 'block';
                modeText.textContent = 'åˆ‡æ¢ä¸ºæ—¥è–ªè¾“å…¥';
            } else {
                dailyInput.style.display = 'block';
                hourlyInput.style.display = 'none';
                modeText.textContent = 'åˆ‡æ¢ä¸ºæ—¶è–ªè¾“å…¥';
            }
        }

        function startMining() {
            let value;
            if (useHourlyInput) {
                value = parseFloat(document.getElementById('hourlyInput').value);
                salary = value;
            } else {
                value = parseFloat(document.getElementById('salaryInput').value);
                salary = value / (workMinutes / 60); // è®¡ç®—æ—¶è–ª
            }
            
            if (value <= 0 || isNaN(value)) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„è–ªèµ„ï¼');
                return;
            }
            
            const startTime = document.getElementById('workStartTime').value;
            const endTime = document.getElementById('workEndTime').value;
            
            localStorage.setItem('salary', value);
            localStorage.setItem('useHourlyInput', useHourlyInput);
            localStorage.setItem('workStartTime', startTime);
            localStorage.setItem('workEndTime', endTime);
            
            showMainInterface();
        }

        function showMainInterface() {
            document.getElementById('setupContainer').style.display = 'none';
            document.getElementById('mainContainer').style.display = 'block';
            
            startTime = Date.now();
            startMoneyCounter();
            startAnimation();
        }

        function startMoneyCounter() {
            moneyInterval = setInterval(() => {
                if (!isPaused && startTime) {
                    updateMoneyDisplay();
                }
            }, updateFrequency);
        }

        function updateMoneyDisplay() {
            const elapsed = (Date.now() - startTime) / 1000;
            const secondsPerWorkDay = workMinutes * 60;
            
            let earned = (salary / 3600) * elapsed;
            
            document.getElementById('moneyAmount').textContent = `Â¥ ${earned.toFixed(decimalPlaces)}`;
            
            const hours = Math.floor(elapsed / 3600);
            const minutes = Math.floor((elapsed % 3600) / 60);
            document.getElementById('timeInfo').textContent = `æœ¬æ¬¡æ‘¸é±¼æ—¶é•¿ï¼š${hours}å°æ—¶${minutes}åˆ†é’Ÿ`;
            
            let displayText;
            if (useHourlyInput) {
                displayText = `ä»Šæ—¥å·²èµšå– | æ—¶è–ªï¼šÂ¥${salary.toFixed(decimalPlaces)} | æ—¥å·¥ä½œï¼š${(workMinutes/60).toFixed(1)}å°æ—¶`;
            } else {
                const dailySalary = salary * (workMinutes / 60);
                displayText = `ä»Šæ—¥å·²èµšå– | æ—¥è–ªï¼šÂ¥${dailySalary.toFixed(decimalPlaces)} | æ—¶è–ªï¼šÂ¥${salary.toFixed(decimalPlaces)}`;
            }
            
            document.getElementById('moneyInfo').textContent = displayText;
        }

        function startAnimation() {
            animationInterval = setInterval(() => {
                if (!isPaused && Math.random() < coinDropRate / 10) {
                    createCoin();
                }
                if (!isPaused && Math.random() < cashDropRate / 10) {
                    createCash();
                }
            }, 1000);
        }

        function createCoin() {
            const coin = document.createElement('div');
            coin.className = 'coin';
            coin.style.left = Math.random() * window.innerWidth + 'px';
            coin.style.animationDuration = ((Math.random() * 3 + 2) / animationSpeed) + 's';
            
            coin.addEventListener('click', function() {
                this.style.transform = 'scale(1.5)';
                this.style.opacity = '0';
                setTimeout(() => this.remove(), 300);
                if (!isMuted) {
                    playCoinSound();
                }
            });
            
            document.body.appendChild(coin);
            
            setTimeout(() => {
                if (coin.parentNode) {
                    coin.remove();
                }
            }, 5000 / animationSpeed);
        }

        function createCash() {
            const cash = document.createElement('div');
            cash.className = 'cash';
            cash.style.left = Math.random() * window.innerWidth + 'px';
            cash.style.animationDuration = ((Math.random() * 4 + 3) / animationSpeed) + 's';
            
            document.body.appendChild(cash);
            
            setTimeout(() => {
                if (cash.parentNode) {
                    cash.remove();
                }
            }, 7000 / animationSpeed);
        }

        function playCoinSound() {
            if (isMuted) return;
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(800 * audioPitch, audioContext.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(1200 * audioPitch, audioContext.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(audioVolume, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.1);
        }

        function togglePause() {
            isPaused = !isPaused;
            document.getElementById('pauseBtn').textContent = isPaused ? 'ç»§ç»­' : 'æš‚åœ';
        }

        function toggleMute() {
            isMuted = !isMuted;
            document.getElementById('muteBtn').textContent = isMuted ? 'å¼€å¯å£°éŸ³' : 'é™éŸ³';
        }

        function resetSettings() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰è®¾ç½®å—ï¼Ÿ')) {
                localStorage.clear();
                location.reload();
            }
        }

        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            if (panel.style.display === 'none' || panel.style.display === '') {
                panel.style.display = 'block';
                loadSettingsToPanel();
            } else {
                panel.style.display = 'none';
            }
        }

        function loadSettingsToPanel() {
            // åŠ è½½è–ªèµ„è®¾ç½®
            document.getElementById('settingsSalaryMode').value = useHourlyInput ? 'hourly' : 'daily';
            document.getElementById('settingsSalaryAmount').value = localStorage.getItem('salary') || '';
            
            // åŠ è½½å·¥ä½œæ—¶é—´
            document.getElementById('settingsStartTime').value = localStorage.getItem('workStartTime') || '09:00';
            document.getElementById('settingsEndTime').value = localStorage.getItem('workEndTime') || '18:00';
            updateWorkSettings();
            
            // åŠ è½½åŠ¨ç”»è®¾ç½®
            document.getElementById('settingsCoinRate').value = coinDropRate;
            document.getElementById('settingsCashRate').value = cashDropRate;
            document.getElementById('settingsAnimSpeed').value = animationSpeed;
            document.getElementById('coinRateValue').textContent = coinDropRate;
            document.getElementById('cashRateValue').textContent = cashDropRate;
            document.getElementById('animSpeedValue').textContent = animationSpeed.toFixed(1) + 'x';
            
            // åŠ è½½æ˜¾ç¤ºè®¾ç½®
            document.getElementById('settingsUpdateFreq').value = updateFrequency;
            document.getElementById('settingsDecimals').value = decimalPlaces;
            document.getElementById('decimalsValue').textContent = decimalPlaces;
            
            // åŠ è½½éŸ³æ•ˆè®¾ç½®
            document.getElementById('settingsVolume').value = audioVolume;
            document.getElementById('settingsPitch').value = audioPitch;
            document.getElementById('volumeValue').textContent = Math.round(audioVolume * 100) + '%';
            document.getElementById('pitchValue').textContent = audioPitch.toFixed(1) + 'x';
        }

        function updateSalaryMode() {
            const mode = document.getElementById('settingsSalaryMode').value;
            useHourlyInput = mode === 'hourly';
        }

        function updateWorkSettings() {
            const startTime = document.getElementById('settingsStartTime').value;
            const endTime = document.getElementById('settingsEndTime').value;
            
            const [startH, startM] = startTime.split(':').map(Number);
            const [endH, endM] = endTime.split(':').map(Number);
            
            let totalMinutes = (endH * 60 + endM) - (startH * 60 + startM);
            if (totalMinutes < 0) totalMinutes += 24 * 60;
            
            workMinutes = totalMinutes;
            document.getElementById('settingsWorkHours').textContent = (workMinutes / 60).toFixed(1) + 'å°æ—¶';
        }

        function updateAnimationSettings() {
            coinDropRate = parseInt(document.getElementById('settingsCoinRate').value);
            cashDropRate = parseInt(document.getElementById('settingsCashRate').value);
            animationSpeed = parseFloat(document.getElementById('settingsAnimSpeed').value);
            
            document.getElementById('coinRateValue').textContent = coinDropRate;
            document.getElementById('cashRateValue').textContent = cashDropRate;
            document.getElementById('animSpeedValue').textContent = animationSpeed.toFixed(1) + 'x';
        }

        function updateDisplaySettings() {
            updateFrequency = parseInt(document.getElementById('settingsUpdateFreq').value);
            decimalPlaces = parseInt(document.getElementById('settingsDecimals').value);
            document.getElementById('decimalsValue').textContent = decimalPlaces;
        }

        function updateAudioSettings() {
            audioVolume = parseFloat(document.getElementById('settingsVolume').value);
            audioPitch = parseFloat(document.getElementById('settingsPitch').value);
            
            document.getElementById('volumeValue').textContent = Math.round(audioVolume * 100) + '%';
            document.getElementById('pitchValue').textContent = audioPitch.toFixed(1) + 'x';
        }

        function applySettings() {
            // ä¿å­˜è–ªèµ„è®¾ç½®
            const newSalaryValue = parseFloat(document.getElementById('settingsSalaryAmount').value);
            if (!isNaN(newSalaryValue) && newSalaryValue > 0) {
                localStorage.setItem('salary', newSalaryValue);
                localStorage.setItem('useHourlyInput', useHourlyInput);
                salary = useHourlyInput ? newSalaryValue : newSalaryValue / (workMinutes / 60);
            }
            
            // ä¿å­˜å·¥ä½œæ—¶é—´
            const startTime = document.getElementById('settingsStartTime').value;
            const endTime = document.getElementById('settingsEndTime').value;
            localStorage.setItem('workStartTime', startTime);
            localStorage.setItem('workEndTime', endTime);
            updateWorkHours();
            
            // ä¿å­˜åŠ¨ç”»è®¾ç½®
            localStorage.setItem('coinDropRate', coinDropRate);
            localStorage.setItem('cashDropRate', cashDropRate);
            localStorage.setItem('animationSpeed', animationSpeed);
            
            // ä¿å­˜æ˜¾ç¤ºè®¾ç½®
            localStorage.setItem('updateFrequency', updateFrequency);
            localStorage.setItem('decimalPlaces', decimalPlaces);
            
            // ä¿å­˜éŸ³æ•ˆè®¾ç½®
            localStorage.setItem('audioVolume', audioVolume);
            localStorage.setItem('audioPitch', audioPitch);
            
            alert('è®¾ç½®å·²ä¿å­˜ï¼éƒ¨åˆ†è®¾ç½®éœ€è¦åˆ·æ–°é¡µé¢æ‰èƒ½å®Œå…¨ç”Ÿæ•ˆã€‚');
            toggleSettings();
            
            // é‡å¯è®¡æ—¶å™¨ä»¥åº”ç”¨æ–°è®¾ç½®
            if (moneyInterval) {
                clearInterval(moneyInterval);
                startMoneyCounter();
            }
        }

        function resetToDefaults() {
            if (confirm('ç¡®å®šè¦æ¢å¤é»˜è®¤è®¾ç½®å—ï¼Ÿ')) {
                // æ¢å¤é»˜è®¤å€¼
                coinDropRate = 3;
                cashDropRate = 1;
                animationSpeed = 1;
                updateFrequency = 100;
                decimalPlaces = 2;
                audioVolume = 0.3;
                audioPitch = 1;
                
                loadSettingsToPanel();
                alert('å·²æ¢å¤é»˜è®¤è®¾ç½®ï¼Œç‚¹å‡»"åº”ç”¨è®¾ç½®"ä¿å­˜æ›´æ”¹ã€‚');
            }
        }

        function showHelp() {
            alert(`ä½¿ç”¨å¸®åŠ©ï¼š

â€¢ æŒ‰ Esc é”®åˆ‡æ¢è€æ¿é”®ä¼ªè£…ç•Œé¢
â€¢ ç‚¹å‡»é‡‘å¸å¯è·å¾—é¢å¤–éŸ³æ•ˆ
â€¢ æ‰€æœ‰æ•°æ®ä»…ä¿å­˜åœ¨æœ¬åœ°æµè§ˆå™¨
â€¢ å¯æš‚åœ/ç»§ç»­è®¡ç®—
â€¢ æ”¯æŒæ—¥è–ªå’Œæ—¶è–ªä¸¤ç§æ¨¡å¼

ç¥æ‚¨æ‘¸é±¼æ„‰å¿«ï¼`);
        }

        // è€æ¿é”®åŠŸèƒ½
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                e.preventDefault();
                const bossScreen = document.getElementById('bossScreen');
                if (bossScreen.style.display === 'none' || bossScreen.style.display === '') {
                    bossScreen.style.display = 'block';
                } else {
                    bossScreen.style.display = 'none';
                }
            }
        });

        // é˜²æ­¢å³é”®èœå•ï¼ˆå¢åŠ éšè”½æ€§ï¼‰
        document.addEventListener('contextmenu', function(e) {
            if (document.getElementById('bossScreen').style.display === 'block') {
                e.preventDefault();
            }
        });
    </script>
</body>
</html>